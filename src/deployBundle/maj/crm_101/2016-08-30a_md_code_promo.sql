CREATE TABLE code_promo_periode_validite (id INT UNSIGNED AUTO_INCREMENT NOT NULL, date_debut DATETIME NOT NULL, date_fin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE code_promo (id INT UNSIGNED AUTO_INCREMENT NOT NULL, code_promo_unifie_id INT UNSIGNED DEFAULT NULL, site_id INT UNSIGNED DEFAULT NULL, libelle VARCHAR(255) NOT NULL, code VARCHAR(255) NOT NULL, client_affectation SMALLINT NOT NULL, type_remise SMALLINT NOT NULL, valeur_remise NUMERIC(10, 2) NOT NULL, prix_mini NUMERIC(10, 2) NOT NULL, usage_code_promo SMALLINT NOT NULL, actif TINYINT(1) NOT NULL, actif_site TINYINT(1) DEFAULT '1' NOT NULL, UNIQUE INDEX UNIQ_5C4683B777153098 (code), INDEX IDX_5C4683B72DEC8E9D (code_promo_unifie_id), INDEX IDX_5C4683B7F6BD1646 (site_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE code_promo_code_promo_periode_validite (code_promo_id INT UNSIGNED NOT NULL, code_promo_periode_validite_id INT UNSIGNED NOT NULL, INDEX IDX_A7988F35294102D4 (code_promo_id), UNIQUE INDEX UNIQ_A7988F35E112517C (code_promo_periode_validite_id), PRIMARY KEY(code_promo_id, code_promo_periode_validite_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE code_promo_code_promo_periode_sejour (code_promo_id INT UNSIGNED NOT NULL, code_promo_periode_sejour_id INT UNSIGNED NOT NULL, INDEX IDX_9ECA6D23294102D4 (code_promo_id), UNIQUE INDEX UNIQ_9ECA6D23488CD340 (code_promo_periode_sejour_id), PRIMARY KEY(code_promo_id, code_promo_periode_sejour_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE code_promo_periode_sejour (id INT UNSIGNED AUTO_INCREMENT NOT NULL, date_debut DATETIME NOT NULL, date_fin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE code_promo_unifie (id INT UNSIGNED AUTO_INCREMENT NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE code_promo ADD CONSTRAINT FK_5C4683B72DEC8E9D FOREIGN KEY (code_promo_unifie_id) REFERENCES code_promo_unifie (id);
ALTER TABLE code_promo ADD CONSTRAINT FK_5C4683B7F6BD1646 FOREIGN KEY (site_id) REFERENCES site (id);
ALTER TABLE code_promo_code_promo_periode_validite ADD CONSTRAINT FK_A7988F35294102D4 FOREIGN KEY (code_promo_id) REFERENCES code_promo (id) ON DELETE CASCADE;
ALTER TABLE code_promo_code_promo_periode_validite ADD CONSTRAINT FK_A7988F35E112517C FOREIGN KEY (code_promo_periode_validite_id) REFERENCES code_promo_periode_validite (id);
ALTER TABLE code_promo_code_promo_periode_sejour ADD CONSTRAINT FK_9ECA6D23294102D4 FOREIGN KEY (code_promo_id) REFERENCES code_promo (id) ON DELETE CASCADE;
ALTER TABLE code_promo_code_promo_periode_sejour ADD CONSTRAINT FK_9ECA6D23488CD340 FOREIGN KEY (code_promo_periode_sejour_id) REFERENCES code_promo_periode_sejour (id);