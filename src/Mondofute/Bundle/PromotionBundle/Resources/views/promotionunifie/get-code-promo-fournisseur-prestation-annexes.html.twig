{% set familleLibelle = "" %}
{% set keyFournisseurPrestationAnnexe = 0 %}
{% for key, fournisseurPrestationAnnexe in fournisseurPrestationAnnexes %}
    {% if familleLibelle != fournisseurPrestationAnnexe.familleLibelle %}
        <li class="list-group-item">
            <div class="checkbox">
                <div class="col-sm-1"></div>
                <div class="col-sm-11"><label>
                        <input type="checkbox"
                               name="mondofute_bundle_promotionbundle_promotionunifie[promotions][{{ keyPromotion }}][promotionFamillePrestationAnnexes][{{ fournisseurId }}{{ key }}][famillePrestationAnnexe]"
                               value="{{ fournisseurPrestationAnnexe.famillePrestationAnnexeId }}"
                               data-list_group="promotion_{{ promotionId }}_fournisseur_{{ fournisseurId }}_prestation_annexes"
                               onclick="checkChilFamillePrestationAnnexe(this,'promotion_famille_prestation_annexes_{{ keyPromotion }}_{{ fournisseurId }}_{{ fournisseurPrestationAnnexe.famillePrestationAnnexeId }}')"
                                {% if promotion.promotionFamillePrestationAnnexes is defined %}
                                    {% for promotionFamillePrestationAnnexe in promotion.promotionFamillePrestationAnnexes %}
                                        {% if
                                        promotionFamillePrestationAnnexe.vars.value.fournisseur.id == fournisseurId
                                        and promotionFamillePrestationAnnexe.vars.value.famillePrestationAnnexe.id == fournisseurPrestationAnnexe.famillePrestationAnnexeId %}
                                            checked="checked"
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                        />
                        {#<a#}
                        {#data-toggle="collapse"#}
                        {#href=""#}
                        {#aria-expanded="true"#}
                        {#aria-controls=""#}
                        {#>#}
                        {{ fournisseurPrestationAnnexe.familleLibelle }}
                        {#</a>#}
                        <input
                                type="hidden"
                                name="mondofute_bundle_promotionbundle_promotionunifie[promotions][{{ keyPromotion }}][promotionFamillePrestationAnnexes][{{ fournisseurId }}{{ key }}][fournisseur]"
                                value="{{ fournisseurId }}"/>
                    </label>
                </div>
            </div>
        </li>
        <li class="list-group-item">
        <ul class="list-group">
    {% endif %}

    <li class="list-group-item">
        <div class="checkbox">
            <div class="col-sm-2"></div>
            <div class="col-sm-10">
                <label><input type="checkbox"
                              value="{{ fournisseurPrestationAnnexe.fournisseurPrestationAnnexeId }}"
                            {#name="promotionFournisseurPrestationAnnexes[{{ promotionId }}][{{ fournisseurId }}][]"#}
                            {% if promotion.promotionFournisseurPrestationAnnexes is defined %}
                                {% for promotionfournisseurPrestationAnnexe in promotion.promotionFournisseurPrestationAnnexes %}
                                    {#{{ dump(promotionfournisseurPrestationAnnexe.vars.value) }}#}
                                    {% if
                                    promotionfournisseurPrestationAnnexe.vars.value.fournisseur.id == fournisseurId
                                    and promotionfournisseurPrestationAnnexe.vars.value.fournisseurPrestationAnnexe.id == fournisseurPrestationAnnexe.fournisseurPrestationAnnexeId %}
                                        {#and promotionfournisseurPrestationAnnexe.vars.value.promotion.id == promotionId #}
                                        checked="checked"
                                    {% endif %}
                                {% endfor %}
                            {% endif %}

                              class="promotion_famille_prestation_annexes_{{ keyPromotion }}_{{ fournisseurId }}_{{ fournisseurPrestationAnnexe.famillePrestationAnnexeId }}"
                              name="mondofute_bundle_promotionbundle_promotionunifie[promotions][{{ keyPromotion }}][promotionFournisseurPrestationAnnexes][{{ fournisseurId }}{{ key }}][fournisseurPrestationAnnexe]"
                    >{{ fournisseurPrestationAnnexe.libelle }}
                </label>
                <input type="hidden"
                       name="mondofute_bundle_promotionbundle_promotionunifie[promotions][{{ keyPromotion }}][promotionFournisseurPrestationAnnexes][{{ fournisseurId }}{{ key }}][fournisseur]"
                       value="{{ fournisseurId }}"/>
            </div>
        </div>
    </li>

    {% set familleLibelle = fournisseurPrestationAnnexe.familleLibelle %}
    {% if fournisseurPrestationAnnexes[key + 1] is not defined or fournisseurPrestationAnnexes[key + 1].familleLibelle != familleLibelle %}
        </ul>
        </li>
    {% endif %}

    {% set keyFournisseurPrestationAnnexe = keyFournisseurPrestationAnnexe + 1 %}
{% endfor %}
{% if fournisseurPrestationAnnexes is empty %}
    <li class="list-group-item">
        <div class="alert alert-info" role="alert">Il n'y a pas de prestation annexes pour ce fournisseur.</div>
    </li>
{% endif %}