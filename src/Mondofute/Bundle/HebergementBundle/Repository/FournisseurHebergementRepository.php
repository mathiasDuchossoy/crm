<?php

namespace Mondofute\Bundle\HebergementBundle\Repository;

use Doctrine\Common\Collections\ArrayCollection;

/**
 * FournisseurHebergementRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class FournisseurHebergementRepository extends \Doctrine\ORM\EntityRepository
{
    public function chargerPourStocks($idHebergementUnifie)
    {
        $qb = $this->getEntityManager()->createQueryBuilder();
        $qb->select('fh')
            ->addSelect('h.id')
            ->addSelect('f.id')
            ->addSelect('logements')
            ->from('MondofuteHebergementBundle:FournisseurHebergement', 'fh')
            ->join('fh.fournisseur', 'f')
            ->join('fh.hebergement', 'h')
            ->leftJoin('fh.logements','logements')
        ->where('h.id = :idHebergementUnifie')
        ->setParameter('idHebergementUnifie',$idHebergementUnifie);
        $result = $qb->getQuery()->getResult();
//        dump(new ArrayCollection($result));
//        die;
//        $qb->select('fh')
//            ->addSelect('fh.fournisseur')
//            ->addSelect('fh.logements')
//            ->addSelect('lt.langue')
//            ->addSelect('lt.nom')
//            ->from('MondofuteHebergementBundle:FournisseurHebergement','fh')
//            ->leftJoin('fh.fournisseur','f')
//            ->leftJoin('fh.logements','l')
//        ->leftJoin('l.site','site')
//        ->leftJoin('l.traductions','lt')
//        ->leftJoin('lt.langue','ltl')
//        ->where('fh.hebergement.id = :idHebergement')
//        ->setParameter('idHebergement',$idHebergementUnifie);
        return new ArrayCollection($result);
    }
}
